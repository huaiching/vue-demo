<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>Vue 教學筆記</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
      height: 100vh;
    }

    nav {
      width: 350px;
      background-color: #f5f5f5;
      padding: 1em;
      border-right: 1px solid #ccc;
      box-sizing: border-box;
      overflow-y: auto;
    }

    nav h2 {
      font-size: 1.2em;
      margin-top: 0;
    }

    nav ul {
      list-style: none;
      padding: 0;
    }

    nav li {
      margin: 0.5em 0;
    }

    nav a {
      color: #007BFF;
      text-decoration: none;
      display: block;
      padding: 0.5em;
      border-radius: 4px;
    }

    nav a:hover {
      background-color: #e7f0ff;
    }

    nav a.active {
      background-color: #007BFF;
      color: white;
      font-weight: bold;
    }

    iframe {
      flex: 1;
      border: none;
    }
  </style>
</head>
<body>
  <nav>
    <h2>Vue 教學筆記</h2>
    <ul id="nav-list"></ul>
  </nav>

  <iframe name="content-frame" id="content-frame"></iframe>

  <script>
    const chapters = [
      { id: '01', title: '建立專案' },
      { id: '02', title: '資料結構與相關元件' },
      { id: '03', title: 'vue的頁面結構' },
      { id: '04', title: '響應式數據 - ref、reactive 和 computed' },
      { id: '05', title: '屬性綁定 - v-bind' },
      { id: '06', title: '事件處理 - v-on' },
      { id: '07', title: '雙向綁定 - v-model' },
      { id: '08', title: '資料傳遞 - props 和 emit' },
      { id: '09', title: '條件渲染 - v-if 和 v-show' },
      { id: '10', title: '動態切換元件 - component' },
      { id: '11', title: '迭代渲染 - v-for' },
      { id: '12', title: '監聽器 - watch' },
      { id: '13', title: '插槽 - slot' },
      { id: '14', title: '生命週期函數' },
      { id: '15', title: 'Pinia - 全域資料管理' },
      { id: '16', title: 'vue-Router - 路由管理' },
    ];

    const navList = document.getElementById('nav-list');
    const iframe = document.getElementById('content-frame');
    const links = []; // 等會兒塞入所有 <a>

    // 產生側邊欄
    const navHTML = chapters.map(chapter => {
      const href = `Components/${chapter.title}.html`;
      return `
        <li>
          <a href="${href}" target="content-frame">${chapter.id} ${chapter.title}</a>
        </li>
      `;
    }).join('');

    navList.innerHTML = navHTML;

    // 取得所有連結（此時 DOM 已更新）
    document.querySelectorAll('nav a').forEach(link => links.push(link));

    // 取得目前 iframe 載入的檔案名稱（相對於 Components/）
    function getCurrentPage() {
      try {
        // 嘗試從 iframe 取得目前路徑（同源時可行）
        const path = iframe.contentWindow.location.pathname;
        return path.split('/').pop(); // 例如：建立專案.html
      } catch (e) {
        // 跨源或尚未載入時，回傳 null
        return null;
      }
    }

    // 根據目前檔案名稱標記 active
    function updateActiveLink() {
      const currentFile = getCurrentPage();
      if (!currentFile) {
        // 還沒載入完成，先不標記
        return;
      }

      const expectedHref = `Components/${currentFile}`;

      links.forEach(link => {
        link.classList.toggle('active', link.getAttribute('href') === expectedHref);
      });
    }

    // 初始載入第一章
    if (chapters.length > 0) {
      const initialHref = `Components/${chapters[0].title}.html`;
      iframe.src = initialHref;

      // 一設定 src 就先強制標記第一個為 active（不用等 load）
      links[0].classList.add('active');
    }

    // 點擊側邊欄時
    links.forEach(link => {
      link.addEventListener('click', () => {
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
      });
    });

    // iframe 每次載入完成後，嘗試同步 active（以防內容頁內有跳轉）
    iframe.addEventListener('load', () => {
      updateActiveLink();
    });
  </script>
</body>
</html>